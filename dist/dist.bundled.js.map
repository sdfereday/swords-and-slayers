{"version":3,"sources":["webpack:///./src/app.js","webpack:///./src/entities/Hero.js","webpack:///./src/helpers/Mix.js","webpack:///./src/components/UserControlled.js","webpack:///./src/entities/Enemy.js","webpack:///./src/ai/nodes/actions/Idle.js","webpack:///./src/ai/nodes/actions/Follow.js","webpack:///./src/ai/nodes/conditions/InRange.js","webpack:///./src/ai/nodes/conditions/OutOfRange.js","webpack:///./src/entities/Weapon.js","webpack:///./src/helpers/Helpers.js"],"names":["game","Game","AUTO","preload","create","update","render","debug","bodyInfo","hero","body","load","spritesheet","image","physics","startSystem","Physics","ARCADE","stage","backgroundColor","input","keyboard","addKeyCapture","Keyboard","LEFT","RIGHT","UP","DOWN","attackKey","addKey","CONTROL","onDown","add","activeWeapon","use","ground","group","x","width","groundBlock","sprite","height","enable","immovable","allowGravity","frame","setSize","heroCenter","y","addChild","enemies","enemy","setTarget","arcade","collide","overlap","weapon","npc","takeDamage","damageOutput","Hero","name","existing","id","stats","hp","maxHp","config","movementSpeed","MAX_SPEED","ACCELERATION","DRAG","GRAVITY","JUMP_SPEED","collideWorldBounds","maxVelocity","setTo","drag","gravity","jumping","leftInputIsActive","velocity","rightInputIsActive","onTheGround","touching","down","jumps","upInputIsActive","upInputReleased","Phaser","Sprite","with","MixinBuilder","superclass","mixins","reduce","c","mixin","UserControlled","isActive","isDown","activePointer","duration","downDuration","justPressed","released","upDuration","justReleased","Enemy","alertRange","currentTarget","blackboard","b3","Blackboard","tree","BehaviorTree","root","Priority","children","Sequence","tick","dist","Dist","set","dirToTarget","get","move","dir","t","n","origin","console","log","Idle","Class","Action","prototype","open","RUNNING","Follow","target","chaseTarget","InRange","Condition","SUCCESS","FAILURE","OutOfRange","Weapon","alpha","enabled","self","setTimeout","Helpers","object","a","b","Math","sqrt"],"mappings":";;;;;;;;;;;;AAAA;;AACA;;AACA;;;;AAGA;;;;AACA;;;;AACA;;;;;;AAEA;AACA;AACA,IAAIA,OAAO,IAAI,iBAAOC,IAAX,CAAgB,GAAhB,EAAqB,GAArB,EAA0B,iBAAOC,IAAjC,EAAuC,gBAAvC,EAAyD;AAChEC,aAASA,OADuD;AAEhEC,YAAQA,MAFwD;AAGhEC,YAAQA,MAHwD;AAIhEC,YAAQA;AAJwD,CAAzD,CAAX;;AAPA;;;AAcA,SAASA,MAAT,GAAkB;;AAEdN,SAAKO,KAAL,CAAWC,QAAX,CAAoB,KAAKC,IAAzB,EAA+B,EAA/B,EAAmC,EAAnC;AACAT,SAAKO,KAAL,CAAWG,IAAX,CAAgB,KAAKD,IAArB;AAEH;;AAED,SAASN,OAAT,GAAmB;;AAEfH,SAAKW,IAAL,CAAUC,WAAV,CAAsB,QAAtB,EAAgC,2BAAhC,EAA6D,GAA7D,EAAkE,GAAlE,EAAuE,EAAvE;AACAZ,SAAKW,IAAL,CAAUE,KAAV,CAAgB,QAAhB,EAA0B,mCAA1B,EAA+D,EAA/D,EAAmE,EAAnE;AACA;AAEH;;AAED,SAAST,MAAT,GAAkB;;AAEd,SAAKJ,IAAL,CAAUc,OAAV,CAAkBC,WAAlB,CAA8B,iBAAOC,OAAP,CAAeC,MAA7C;AACA,SAAKjB,IAAL,CAAUkB,KAAV,CAAgBC,eAAhB,GAAkC,SAAlC;;AAEA;AACA;AACA;AACA,SAAKnB,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyBC,aAAzB,CAAuC,CACnC,iBAAOC,QAAP,CAAgBC,IADmB,EAEnC,iBAAOD,QAAP,CAAgBE,KAFmB,EAGnC,iBAAOF,QAAP,CAAgBG,EAHmB,EAInC,iBAAOH,QAAP,CAAgBI,IAJmB,CAAvC;;AAOA,SAAKC,SAAL,GAAiB,KAAK5B,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyBQ,MAAzB,CAAgC,iBAAON,QAAP,CAAgBO,OAAhD,CAAjB;;AAEA,SAAKF,SAAL,CAAeG,MAAf,CAAsBC,GAAtB,CAA0B,YAAY;AAClC,aAAKC,YAAL,CAAkBC,GAAlB;AACH,KAFD,EAEG,IAFH;;AAIA;AACA,SAAKC,MAAL,GAAc,KAAKnC,IAAL,CAAUgC,GAAV,CAAcI,KAAd,EAAd;AACA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI,KAAKrC,IAAL,CAAUsC,KAA9B,EAAqCD,KAAK,EAA1C,EAA8C;AAC1C;AACA,YAAIE,cAAc,KAAKvC,IAAL,CAAUgC,GAAV,CAAcQ,MAAd,CAAqBH,CAArB,EAAwB,KAAKrC,IAAL,CAAUyC,MAAV,GAAmB,EAA3C,EAA+C,QAA/C,CAAlB;AACA,aAAKzC,IAAL,CAAUc,OAAV,CAAkB4B,MAAlB,CAAyBH,WAAzB,EAAsC,iBAAOvB,OAAP,CAAeC,MAArD;AACAsB,oBAAY7B,IAAZ,CAAiBiC,SAAjB,GAA6B,IAA7B;AACAJ,oBAAY7B,IAAZ,CAAiBkC,YAAjB,GAAgC,KAAhC;AACA,aAAKT,MAAL,CAAYH,GAAZ,CAAgBO,WAAhB;AACH;;AAED,SAAK9B,IAAL,GAAY,mBAAST,IAAT,EAAe,GAAf,EAAoB,GAApB,EAAyB,QAAzB,CAAZ;AACA,SAAKS,IAAL,CAAUoC,KAAV,GAAkB,CAAlB;;AAEA,SAAKpC,IAAL,CAAUC,IAAV,CAAeoC,OAAf,CAAuB,EAAvB,EAA2B,EAA3B,EAA+B,EAA/B,EAAmC,EAAnC;;AAEA;AACA,QAAIC,aAAa;AACbV,WAAI,KAAK5B,IAAL,CAAU4B,CAAV,GAAc,CADL;AAEbW,WAAI,KAAKvC,IAAL,CAAUuC,CAAV,GAAc;AAFL,KAAjB;;AAKA,SAAKf,YAAL,GAAoB,qBAAWjC,IAAX,EAAiB+C,WAAWV,CAA5B,EAA+BU,WAAWC,CAA1C,EAA6C,YAA7C,CAApB;AACA,SAAKvC,IAAL,CAAUwC,QAAV,CAAmB,KAAKhB,YAAxB;;AAEA,SAAKA,YAAL,CAAkBI,CAAlB,IAAuB,KAAKJ,YAAL,CAAkBK,KAAzC;AACA,SAAKL,YAAL,CAAkBe,CAAlB,IAAuB,KAAKf,YAAL,CAAkBQ,MAAzC;;AAEA;AACA,SAAKS,OAAL,GAAelD,KAAKgC,GAAL,CAASI,KAAT,EAAf;AACA,QAAIe,QAAQ,oBAAUnD,IAAV,EAAgB,EAAhB,EAAoB,GAApB,EAAyB,QAAzB,CAAZ;AACA,SAAKkD,OAAL,CAAalB,GAAb,CAAiBmB,KAAjB;;AAEAA,UAAMC,SAAN,CAAgB,KAAK3C,IAArB;AAEH;;AAED,SAASJ,MAAT,GAAkB;;AAEd,SAAKL,IAAL,CAAUc,OAAV,CAAkBuC,MAAlB,CAAyBC,OAAzB,CAAiC,KAAK7C,IAAtC,EAA4C,KAAK0B,MAAjD;AACA,SAAKnC,IAAL,CAAUc,OAAV,CAAkBuC,MAAlB,CAAyBC,OAAzB,CAAiC,KAAKJ,OAAtC,EAA+C,KAAKf,MAApD;;AAEA,SAAKnC,IAAL,CAAUc,OAAV,CAAkBuC,MAAlB,CAAyBE,OAAzB,CAAiC,KAAKtB,YAAtC,EAAoD,KAAKiB,OAAzD,EAAkE,UAAUM,MAAV,EAAkBC,GAAlB,EAAuB;AACrFA,YAAIC,UAAJ,CAAeF,OAAOG,YAAP,EAAf,EAAsC;AAClCtB,eAAGmB,OAAOnB,CADwB;AAElCW,eAAGQ,OAAOR;AAFwB,SAAtC;AAIH,KALD,EAKG,IALH,EAKS,IALT;AAOH,C;;;;;;;;;;;;;;;;;;;ACvGD;;;;AACA;;;;;;;;;;;;IAEMY,I;;;AAEF,sBAAY5D,IAAZ,EAAkBqC,CAAlB,EAAqBW,CAArB,EAAwBa,IAAxB,EAA8B;AAAA;;AAAA,wHAGpB7D,IAHoB,EAGdqC,CAHc,EAGXW,CAHW,EAGRa,IAHQ;;AAE1B;;;AAGA7D,qBAAKgC,GAAL,CAAS8B,QAAT;AACA9D,qBAAKc,OAAL,CAAauC,MAAb,CAAoBX,MAApB;;AAEA;AACA,sBAAKqB,EAAL,GAAU,KAAV;AACA,sBAAKF,IAAL,GAAYA,IAAZ;;AAEA,sBAAKG,KAAL,GAAa;AACTC,4BAAI,CADK;AAETC,+BAAO;AAFE,iBAAb;;AAKA,sBAAKC,MAAL,GAAc;AACVC,uCAAe;AADL,iBAAd;;AAIA;AACA,sBAAKC,SAAL,GAAiB,GAAjB,CAtB0B,CAsBJ;AACtB,sBAAKC,YAAL,GAAoB,IAApB,CAvB0B,CAuBA;AAC1B,sBAAKC,IAAL,GAAY,GAAZ,CAxB0B,CAwBT;AACjB,sBAAKC,OAAL,GAAe,IAAf,CAzB0B,CAyBL;AACrB,sBAAKC,UAAL,GAAkB,CAAC,GAAnB,CA1B0B,CA0BF;;AAExB;AACA,sBAAK/D,IAAL,CAAUgE,kBAAV,GAA+B,IAA/B;;AAEA;AACA,sBAAKhE,IAAL,CAAUiE,WAAV,CAAsBC,KAAtB,CAA4B,MAAKP,SAAjC,EAA4C,MAAKA,SAAL,GAAiB,EAA7D,EAhC0B,CAgCwC;;AAElE;AACA,sBAAK3D,IAAL,CAAUmE,IAAV,CAAeD,KAAf,CAAqB,MAAKL,IAA1B,EAAgC,CAAhC,EAnC0B,CAmCU;;AAEpC;AACAvE,qBAAKc,OAAL,CAAauC,MAAb,CAAoByB,OAApB,CAA4B9B,CAA5B,GAAgC,MAAKwB,OAArC;;AAEA;AACA,sBAAKO,OAAL,GAAe,KAAf;;AAzC0B;AA2C7B;;;;yCAEQ;;AAEL,4BAAI,KAAKC,iBAAL,EAAJ,EAA8B;AAC1B;AACA;AACA,qCAAKtE,IAAL,CAAUuE,QAAV,CAAmB5C,CAAnB,GAAuB,CAAC,KAAKiC,YAA7B;AACH,yBAJD,MAIO,IAAI,KAAKY,kBAAL,EAAJ,EAA+B;AAClC;AACA;AACA,qCAAKxE,IAAL,CAAUuE,QAAV,CAAmB5C,CAAnB,GAAuB,KAAKiC,YAA5B;AACH,yBAJM,MAIA;AACH,qCAAK5D,IAAL,CAAUuE,QAAV,CAAmB5C,CAAnB,GAAuB,CAAvB;AACH;;AAED;AACA,4BAAI8C,cAAc,KAAKzE,IAAL,CAAU0E,QAAV,CAAmBC,IAArC;;AAEA;AACA,4BAAIF,WAAJ,EAAiB;AACb,qCAAKG,KAAL,GAAa,CAAb;AACA,qCAAKP,OAAL,GAAe,KAAf;AACH;;AAED;AACA,4BAAI,KAAKO,KAAL,GAAa,CAAb,IAAkB,KAAKC,eAAL,CAAqB,GAArB,CAAtB,EAAiD;AAC7C,qCAAK7E,IAAL,CAAUuE,QAAV,CAAmBjC,CAAnB,GAAuB,KAAKyB,UAA5B;AACA,qCAAKM,OAAL,GAAe,IAAf;AACH;;AAED;AACA,4BAAI,KAAKA,OAAL,IAAgB,KAAKS,eAAL,EAApB,EAA4C;AACxC,qCAAKF,KAAL;AACA,qCAAKP,OAAL,GAAe,KAAf;AACH;AAEJ;;;;EAlFc,mBAAIU,OAAOC,MAAX,EAAmBC,IAAnB,0B;;kBAsFJ/B,I;;;;;;;;;;;;;;;;;ICzFTgC,Y;AACF,0BAAYC,UAAZ,EAAwB;AAAA;;AACpB,aAAKA,UAAL,GAAkBA,UAAlB;AACH;;;;gCAEe;AAAA,8CAARC,MAAQ;AAARA,sBAAQ;AAAA;;AACZ,mBAAOA,OAAOC,MAAP,CAAc,UAACC,CAAD,EAAIC,KAAJ;AAAA,uBAAcA,MAAMD,CAAN,CAAd;AAAA,aAAd,EAAsC,KAAKH,UAA3C,CAAP;AACH;;;;;;kBAGU,UAACA,UAAD;AAAA,WAAgB,IAAID,YAAJ,CAAiBC,UAAjB,CAAhB;AAAA,C;;;;;;;;;;;;;;;;;;;;;ACVf,IAAIK,iBAAiB,SAAjBA,cAAiB,CAACL,UAAD;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;;;AAEjB;AACA;AACA;AACA;AALiB,gDAMG;AAChB,oBAAIM,WAAW,KAAf;;AAEAA,2BAAW,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyB+E,MAAzB,CAAgCX,OAAOlE,QAAP,CAAgBC,IAAhD,CAAX;AACA2E,4BAAa,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BD,MAA9B,IACT,KAAKpG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BhE,CAA9B,GAAkC,KAAKrC,IAAL,CAAUsC,KAAV,GAAkB,CADxD;;AAGA,uBAAO6D,QAAP;AACH;;AAED;AACA;AACA;;AAlBiB;AAAA;AAAA,iDAmBI;AACjB,oBAAIA,WAAW,KAAf;;AAEAA,2BAAW,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyB+E,MAAzB,CAAgCX,OAAOlE,QAAP,CAAgBE,KAAhD,CAAX;AACA0E,4BAAa,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BD,MAA9B,IACT,KAAKpG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BhE,CAA9B,GAAkC,KAAKrC,IAAL,CAAUsC,KAAV,GAAkB,CAAlB,GAAsB,KAAKtC,IAAL,CAAUsC,KAAV,GAAkB,CAD9E;;AAGA,uBAAO6D,QAAP;AACH;;AAED;AACA;AACA;;AA/BiB;AAAA;AAAA,4CAgCDG,QAhCC,EAgCS;AACtB,oBAAIH,WAAW,KAAf;;AAEAA,2BAAW,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyBkF,YAAzB,CAAsCd,OAAOlE,QAAP,CAAgBG,EAAtD,EAA0D4E,QAA1D,CAAX;AACAH,4BAAa,KAAKnG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BG,WAA9B,CAA0CF,WAAW,OAAO,EAA5D,KACT,KAAKtG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BhE,CAA9B,GAAkC,KAAKrC,IAAL,CAAUsC,KAAV,GAAkB,CAD3C,IAET,KAAKtC,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BhE,CAA9B,GAAkC,KAAKrC,IAAL,CAAUsC,KAAV,GAAkB,CAAlB,GAAsB,KAAKtC,IAAL,CAAUsC,KAAV,GAAkB,CAF9E;;AAIA,uBAAO6D,QAAP;AACH;;AAED;;AA3CiB;AAAA;AAAA,8CA4CC;AACd,oBAAIM,WAAW,KAAf;;AAEAA,2BAAW,KAAKzG,IAAL,CAAUoB,KAAV,CAAgBC,QAAhB,CAAyBqF,UAAzB,CAAoCjB,OAAOlE,QAAP,CAAgBG,EAApD,CAAX;AACA+E,4BAAY,KAAKzG,IAAL,CAAUoB,KAAV,CAAgBiF,aAAhB,CAA8BM,YAA9B,EAAZ;;AAEA,uBAAOF,QAAP;AACH;AAnDgB;;AAAA;AAAA,MAA8BZ,UAA9B;AAAA,CAArB;;kBAuDeK,c;;;;;;;;;;;;;;;ACtDf;;;;AAGA;;;;AACA;;;;AAGA;;;;AACA;;;;;;;;;;+eATA;;;AAGA;;;AAIA;;;IAIMU,K;;;AAEF,mBAAY5G,IAAZ,EAAkBqC,CAAlB,EAAqBW,CAArB,EAAwBa,IAAxB,EAA8B;AAAA;;AAAA,kHAGpB7D,IAHoB,EAGdqC,CAHc,EAGXW,CAHW,EAGRa,IAHQ;;AAE1B;;;AAGA7D,aAAKgC,GAAL,CAAS8B,QAAT;AACA9D,aAAKc,OAAL,CAAauC,MAAb,CAAoBX,MAApB;;AAEA;AACA,cAAKqB,EAAL,GAAU,KAAV;AACA,cAAKF,IAAL,GAAYA,IAAZ;;AAEA,cAAKG,KAAL,GAAa;AACTC,gBAAI,CADK;AAETC,mBAAO;AAFE,SAAb;;AAKA,cAAKC,MAAL,GAAc;AACVC,2BAAe,GADL;AAEVyC,wBAAY;AAFF,SAAd;;AAKA,cAAKC,aAAL,GAAqB,IAArB;;AAEA;AACA,cAAKC,UAAL,GAAkB,IAAIC,GAAGC,UAAP,EAAlB;AACA,cAAKC,IAAL,GAAY,IAAIF,GAAGG,YAAP,EAAZ;;AAEA;AACA;AACA;AACA;AACA,cAAKD,IAAL,CAAUE,IAAV,GAAiB,IAAIJ,GAAGK,QAAP,CAAgB;AAC7BC,sBAAU,CACN,IAAIN,GAAGO,QAAP,CAAgB;AACZD,0BAAU,CACN,0BADM,EAEN,oBAFM;AADE,aAAhB,CADM,EAON,IAAIN,GAAGO,QAAP,CAAgB;AACZD,0BAAU,CACN,uBADM,EAEN,sBAFM;AADE,aAAhB,CAPM;AADmB,SAAhB,CAAjB;;AAhC0B;AAiD7B;;;;iCAEQ;;AAEL,iBAAK5G,IAAL,CAAUuE,QAAV,CAAmB5C,CAAnB,GAAuB,CAAvB;;AAEA,iBAAK6E,IAAL,CAAUM,IAAV,CAAe,IAAf,EAAqB,KAAKT,UAA1B;;AAEA,gBAAI,KAAKD,aAAT,EAAwB;AACpB,oBAAIW,OAAO,kBAAQC,IAAR,CAAa,IAAb,EAAmB,KAAKZ,aAAxB,CAAX;AACA,qBAAKC,UAAL,CAAgBY,GAAhB,CAAoB,iBAApB,EAAuCF,OAAO,KAAKtD,MAAL,CAAY0C,UAA1D;AACH;AAEJ;;;sCAEa;;AAEV,gBAAIe,cAAc,KAAKb,UAAL,CAAgBc,GAAhB,CAAoB,eAApB,EAAqCxF,CAArC,GAAyC,KAAKA,CAA9C,GAAkD,CAAlD,GAAsD,CAAC,CAAzE;AACA,iBAAKyF,IAAL,CAAUF,WAAV;AAEH;;;6BAEIG,G,EAAK;;AAEN,gBAAI,kBAAQL,IAAR,CAAa,IAAb,EAAmB,KAAKZ,aAAxB,IAAyC,CAA7C,EACI;;AAEJ,iBAAKpG,IAAL,CAAUuE,QAAV,CAAmB5C,CAAnB,IAAwB0F,MAAM,CAAN,GAAU,KAAK5D,MAAL,CAAYC,aAAtB,GAAsC,CAAC,KAAKD,MAAL,CAAYC,aAA3E;AAEH;;;kCAES4D,C,EAAG;;AAET,iBAAKlB,aAAL,GAAqBkB,CAArB;AACA,iBAAKjB,UAAL,CAAgBY,GAAhB,CAAoB,eAApB,EAAqC,KAAKb,aAA1C;AAEH;;;mCAEUmB,C,EAAGC,M,EAAQ;;AAElBC,oBAAQC,GAAR,CAAY,KAAKvE,IAAL,GAAY,qBAAZ,GAAoCoE,CAAhD;AACAE,oBAAQC,GAAR,CAAYF,MAAZ,EAAoB,uBAApB;AAEH;;;;EA9FezC,OAAOC,M;;kBAkGZkB,K;;;;;;;;;;;;;AC7Gf;AACA,IAAIyB,OAAOrB,GAAGsB,KAAH,CAAStB,GAAGuB,MAAZ,CAAX;;AAEAF,KAAKG,SAAL,CAAe3E,IAAf,GAAsB,MAAtB;;AAEAwE,KAAKG,SAAL,CAAeC,IAAf,GAAsB,UAAUjB,IAAV,EAAgB;;AAElCW,YAAQC,GAAR,CAAY,SAAZ;AACAD,YAAQC,GAAR,CAAYZ,IAAZ;AAEH,CALD;;AAOAa,KAAKG,SAAL,CAAehB,IAAf,GAAsB,UAAUA,IAAV,EAAgB;;AAElC,WAAOR,GAAG0B,OAAV;AAEH,CAJD;;kBAMeL,I;;;;;;;;;;;;;;AClBf;;AAEA,IAAIM,SAAS3B,GAAGsB,KAAH,CAAStB,GAAGuB,MAAZ,CAAb;;AAEAI,OAAOH,SAAP,CAAiB3E,IAAjB,GAAwB,QAAxB;;AAEA8E,OAAOH,SAAP,CAAiBC,IAAjB,GAAwB,UAAUjB,IAAV,EAAgB;;AAEpCW,YAAQC,GAAR,CAAY,WAAZ;AACAD,YAAQC,GAAR,CAAYZ,IAAZ;AAEH,CALD;;AAOAmB,OAAOH,SAAP,CAAiBhB,IAAjB,GAAwB,UAAUA,IAAV,EAAgB;;AAEpCA,SAAKoB,MAAL,CAAYC,WAAZ;AACA,WAAO7B,GAAG0B,OAAV;AAEH,CALD;;kBAOeC,M;;;;;;;;;;;;;;ACpBf;;AAEA,IAAIG,UAAU9B,GAAGsB,KAAH,CAAStB,GAAG+B,SAAZ,CAAd;;AAEAD,QAAQN,SAAR,CAAkB3E,IAAlB,GAAyB,SAAzB;;AAEAiF,QAAQN,SAAR,CAAkBhB,IAAlB,GAAyB,UAAUA,IAAV,EAAgB;;AAErC,QAAIA,KAAKT,UAAL,CAAgBc,GAAhB,CAAoB,iBAApB,CAAJ,EACI,OAAOb,GAAGgC,OAAV;;AAEJ,WAAOhC,GAAGiC,OAAV;AAEH,CAPD;;kBASeH,O;;;;;;;;;;;;;;ACff;;AAEA,IAAII,aAAalC,GAAGsB,KAAH,CAAStB,GAAG+B,SAAZ,CAAjB;;AAEAG,WAAWV,SAAX,CAAqB3E,IAArB,GAA4B,YAA5B;;AAEAqF,WAAWV,SAAX,CAAqBhB,IAArB,GAA4B,UAAUA,IAAV,EAAgB;;AAExC,QAAI,CAACA,KAAKT,UAAL,CAAgBc,GAAhB,CAAoB,iBAApB,CAAL,EACI,OAAOb,GAAGgC,OAAV;;AAEJ,WAAOhC,GAAGiC,OAAV;AAEH,CAPD;;kBASeC,U;;;;;;;;;;;;;;;;;;;;;;ICfTC,M;;;AAEF,oBAAYnJ,IAAZ,EAAkBqC,CAAlB,EAAqBW,CAArB,EAAwBa,IAAxB,EAA8B;AAAA;;AAAA,oHAEpB7D,IAFoB,EAEdqC,CAFc,EAEXW,CAFW,EAERa,IAFQ;;AAI1B7D,aAAKgC,GAAL,CAAS8B,QAAT;AACA9D,aAAKc,OAAL,CAAauC,MAAb,CAAoBX,MAApB;;AAEA,cAAKqB,EAAL,GAAU,KAAV;AACA,cAAKF,IAAL,GAAYA,IAAZ;AACA,cAAKnD,IAAL,CAAUkC,YAAV,GAAyB,KAAzB;AACA,cAAKlC,IAAL,CAAUgC,MAAV,GAAmB,KAAnB;AACA,cAAK0G,KAAL,GAAa,CAAb;;AAEA;AACA,cAAKpF,KAAL,GAAa;AACTL,0BAAc;AADL,SAAb;;AAd0B;AAkB7B;;;;uCAEc;AACX,mBAAO,KAAKK,KAAL,CAAWL,YAAlB;AACH;;;8BAEK;;AAEF;AACA,gBAAI,KAAKjD,IAAL,CAAU2I,OAAd,EACI;;AAEJ,iBAAK3I,IAAL,CAAUgC,MAAV,GAAmB,IAAnB;AACA,iBAAK0G,KAAL,GAAa,CAAb;;AAEA,gBAAIE,OAAO,IAAX;AACAC,uBAAW,YAAY;AACnBD,qBAAK5I,IAAL,CAAUgC,MAAV,GAAmB,KAAnB;AACA4G,qBAAKF,KAAL,GAAa,CAAb;AACH,aAHD,EAGG,GAHH;AAKH;;;;EAzCgB3D,OAAOC,M;;kBA6CbyD,M;;;;;;;;;;;;;;;;;;IC7CTK,O;;;;;;;qCAEUC,M,EAAQb,M,EAAQ;;AAExB,4BAAIc,IAAID,OAAOpH,CAAP,GAAWuG,OAAOvG,CAA1B;AACA,4BAAIsH,IAAIF,OAAOzG,CAAP,GAAW4F,OAAO5F,CAA1B;;AAEA,+BAAO4G,KAAKC,IAAL,CAAUH,IAAIA,CAAJ,GAAQC,IAAIA,CAAtB,CAAP;AAEH;;;;;;kBAIUH,O","file":"dist.bundled.js","sourcesContent":["import 'pixi';\r\nimport 'p2';\r\nimport Phaser from 'phaser';\r\n\r\n// TODO: Move to factories\r\nimport Hero from '../src/entities/Hero';\r\nimport Enemy from '../src/entities/Enemy';\r\nimport Weapon from '../src/entities/Weapon';\r\n\r\n//// TODO: Fix the problem with the relative import urls\r\n//// TODO: Convert to es6\r\nlet game = new Phaser.Game(800, 600, Phaser.AUTO, 'phaser-example', {\r\n    preload: preload,\r\n    create: create,\r\n    update: update,\r\n    render: render\r\n});\r\n\r\nfunction render() {\r\n\r\n    game.debug.bodyInfo(this.hero, 32, 32);\r\n    game.debug.body(this.hero);\r\n\r\n}\r\n\r\nfunction preload() {\r\n\r\n    game.load.spritesheet('player', 'resources/Game/player.png', 128, 128, 18);\r\n    game.load.image('ground', 'resources/Game/platform tile2.png', 32, 32);\r\n    // game.load.spritesheet('veggies', 'assets/sprites/fruitnveg32wh37.png', 32, 32);\r\n\r\n}\r\n\r\nfunction create() {\r\n\r\n    this.game.physics.startSystem(Phaser.Physics.ARCADE);\r\n    this.game.stage.backgroundColor = '#2d2d2d';\r\n\r\n    // Capture certain keys to prevent their default actions in the browser.\r\n    // This is only necessary because this is an HTML5 game. Games on other\r\n    // platforms may not need code like this.\r\n    this.game.input.keyboard.addKeyCapture([\r\n        Phaser.Keyboard.LEFT,\r\n        Phaser.Keyboard.RIGHT,\r\n        Phaser.Keyboard.UP,\r\n        Phaser.Keyboard.DOWN\r\n    ]);\r\n\r\n    this.attackKey = this.game.input.keyboard.addKey(Phaser.Keyboard.CONTROL);\r\n\r\n    this.attackKey.onDown.add(function () {\r\n        this.activeWeapon.use();\r\n    }, this);\r\n\r\n    // Create some ground for the player to walk on\r\n    this.ground = this.game.add.group();\r\n    for (var x = 0; x < this.game.width; x += 32) {\r\n        // Add the ground blocks, enable physics on each, make them immovable\r\n        var groundBlock = this.game.add.sprite(x, this.game.height - 32, 'ground');\r\n        this.game.physics.enable(groundBlock, Phaser.Physics.ARCADE);\r\n        groundBlock.body.immovable = true;\r\n        groundBlock.body.allowGravity = false;\r\n        this.ground.add(groundBlock);\r\n    }\r\n\r\n    this.hero = new Hero(game, 120, 100, 'player');\r\n    this.hero.frame = 1;\r\n\r\n    this.hero.body.setSize(48, 48, 48, 80);\r\n\r\n    // Weapons attach to the player, but we make a reference here (easier to deal with)\r\n    let heroCenter = {\r\n        x: (this.hero.x / 2),\r\n        y: (this.hero.y / 2)\r\n    }\r\n\r\n    this.activeWeapon = new Weapon(game, heroCenter.x, heroCenter.y, 'weapon-gfx');\r\n    this.hero.addChild(this.activeWeapon);\r\n\r\n    this.activeWeapon.x += this.activeWeapon.width;\r\n    this.activeWeapon.y += this.activeWeapon.height;\r\n\r\n    // This risks getting messy, just ensure that stuff is separated out per thing it does.\r\n    this.enemies = game.add.group();\r\n    let enemy = new Enemy(game, 90, 100, 'player');\r\n    this.enemies.add(enemy);\r\n\r\n    enemy.setTarget(this.hero);\r\n\r\n}\r\n\r\nfunction update() {\r\n\r\n    this.game.physics.arcade.collide(this.hero, this.ground);\r\n    this.game.physics.arcade.collide(this.enemies, this.ground);\r\n\r\n    this.game.physics.arcade.overlap(this.activeWeapon, this.enemies, function (weapon, npc) {\r\n        npc.takeDamage(weapon.damageOutput(), {\r\n            x: weapon.x,\r\n            y: weapon.y\r\n        });\r\n    }, null, this);\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import mix from '../helpers/Mix';\r\nimport UserControlled from '../components/UserControlled';\r\n\r\nclass Hero extends mix(Phaser.Sprite).with(UserControlled) {\r\n\r\n    constructor(game, x, y, name) {\r\n\r\n        // Phaser requires all of these to happen\r\n        super(game, x, y, name);\r\n\r\n        game.add.existing(this);\r\n        game.physics.arcade.enable(this);\r\n\r\n        // Custom stats and things\r\n        this.id = \"???\";\r\n        this.name = name;\r\n\r\n        this.stats = {\r\n            hp: 4,\r\n            maxHp: 4\r\n        };\r\n\r\n        this.config = {\r\n            movementSpeed: 200\r\n        };\r\n\r\n        /////\r\n        this.MAX_SPEED = 500; // pixels/second\r\n        this.ACCELERATION = 1500; // pixels/second/second\r\n        this.DRAG = 600; // pixels/second\r\n        this.GRAVITY = 2600; // pixels/second/second\r\n        this.JUMP_SPEED = -700; // pixels/second (negative y is up)\r\n\r\n        // Make player collide with world boundaries so he doesn't leave the stage\r\n        this.body.collideWorldBounds = true;\r\n\r\n        // Set player minimum and maximum movement speed\r\n        this.body.maxVelocity.setTo(this.MAX_SPEED, this.MAX_SPEED * 10); // x, y\r\n\r\n        // Add drag to the player that slows them down when they are not accelerating\r\n        this.body.drag.setTo(this.DRAG, 0); // x, y\r\n\r\n        // Since we're jumping we need gravity\r\n        game.physics.arcade.gravity.y = this.GRAVITY;\r\n\r\n        // Flag to track if the jump button is pressed\r\n        this.jumping = false;\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        if (this.leftInputIsActive()) {\r\n            // If the LEFT key is down, set the player velocity to move left\r\n            //this.body.acceleration.x = -this.ACCELERATION;\r\n            this.body.velocity.x = -this.ACCELERATION;\r\n        } else if (this.rightInputIsActive()) {\r\n            // If the RIGHT key is down, set the player velocity to move right\r\n            //this.body.acceleration.x = this.ACCELERATION;\r\n            this.body.velocity.x = this.ACCELERATION;\r\n        } else {\r\n            this.body.velocity.x = 0;\r\n        }\r\n\r\n        // Set a variable that is true when the player is touching the ground\r\n        var onTheGround = this.body.touching.down;\r\n\r\n        // If the player is touching the ground, let him have 2 jumps\r\n        if (onTheGround) {\r\n            this.jumps = 2;\r\n            this.jumping = false;\r\n        }\r\n\r\n        // Jump! Keep y velocity constant while the jump button is held for up to 150 ms\r\n        if (this.jumps > 0 && this.upInputIsActive(150)) {\r\n            this.body.velocity.y = this.JUMP_SPEED;\r\n            this.jumping = true;\r\n        }\r\n\r\n        // Reduce the number of available jumps if the jump input is released\r\n        if (this.jumping && this.upInputReleased()) {\r\n            this.jumps--;\r\n            this.jumping = false;\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Hero;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/Hero.js","class MixinBuilder {\r\n    constructor(superclass) {\r\n        this.superclass = superclass;\r\n    }\r\n\r\n    with(...mixins) {\r\n        return mixins.reduce((c, mixin) => mixin(c), this.superclass);\r\n    }\r\n}\r\n\r\nexport default (superclass) => new MixinBuilder(superclass);\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/Mix.js","let UserControlled = (superclass) => class extends superclass {\r\n\r\n    //// TODO: Move this lot out of here and in to global. It'll be easier to configure from there.\r\n    // This function should return true when the player activates the \"go left\" control\r\n    // In this case, either holding the right arrow or tapping or clicking on the left\r\n    // side of the screen.\r\n    leftInputIsActive() {\r\n        let isActive = false;\r\n\r\n        isActive = this.game.input.keyboard.isDown(Phaser.Keyboard.LEFT);\r\n        isActive |= (this.game.input.activePointer.isDown &&\r\n            this.game.input.activePointer.x < this.game.width / 4);\r\n\r\n        return isActive;\r\n    }\r\n\r\n    // This function should return true when the player activates the \"go right\" control\r\n    // In this case, either holding the right arrow or tapping or clicking on the right\r\n    // side of the screen.\r\n    rightInputIsActive() {\r\n        let isActive = false;\r\n\r\n        isActive = this.game.input.keyboard.isDown(Phaser.Keyboard.RIGHT);\r\n        isActive |= (this.game.input.activePointer.isDown &&\r\n            this.game.input.activePointer.x > this.game.width / 2 + this.game.width / 4);\r\n\r\n        return isActive;\r\n    }\r\n\r\n    // This function should return true when the player activates the \"jump\" control\r\n    // In this case, either holding the up arrow or tapping or clicking on the center\r\n    // part of the screen.\r\n    upInputIsActive(duration) {\r\n        let isActive = false;\r\n\r\n        isActive = this.game.input.keyboard.downDuration(Phaser.Keyboard.UP, duration);\r\n        isActive |= (this.game.input.activePointer.justPressed(duration + 1000 / 60) &&\r\n            this.game.input.activePointer.x > this.game.width / 4 &&\r\n            this.game.input.activePointer.x < this.game.width / 2 + this.game.width / 4);\r\n\r\n        return isActive;\r\n    }\r\n\r\n    // This function returns true when the player releases the \"jump\" control\r\n    upInputReleased() {\r\n        let released = false;\r\n\r\n        released = this.game.input.keyboard.upDuration(Phaser.Keyboard.UP);\r\n        released |= this.game.input.activePointer.justReleased();\r\n\r\n        return released;\r\n    }\r\n\r\n};\r\n\r\nexport default UserControlled;\n\n\n// WEBPACK FOOTER //\n// ./src/components/UserControlled.js","// Helpers\r\nimport Helpers from '../helpers/Helpers';\r\n\r\n// Actions\r\nimport Idle from '../ai/nodes/actions/Idle';\r\nimport Follow from '../ai/nodes/actions/Follow';\r\n\r\n// Conditions\r\nimport InRange from '../ai/nodes/conditions/InRange';\r\nimport OutOfRange from '../ai/nodes/conditions/OutOfRange';\r\n\r\nclass Enemy extends Phaser.Sprite {\r\n\r\n    constructor(game, x, y, name) {\r\n\r\n        // Phaser requires all of these to happen\r\n        super(game, x, y, name);\r\n\r\n        game.add.existing(this);\r\n        game.physics.arcade.enable(this);\r\n\r\n        // Custom stats and things\r\n        this.id = \"???\";\r\n        this.name = name;\r\n\r\n        this.stats = {\r\n            hp: 4,\r\n            maxHp: 4\r\n        };\r\n\r\n        this.config = {\r\n            movementSpeed: 200,\r\n            alertRange: 200\r\n        };\r\n\r\n        this.currentTarget = null;\r\n\r\n        // There should probably be only one tree instance, not one per entity\r\n        this.blackboard = new b3.Blackboard();\r\n        this.tree = new b3.BehaviorTree();\r\n\r\n        // https://www.gamasutra.com/blogs/ChrisSimpson/20140717/221339/Behavior_trees_for_AI_How_they_work.php\r\n        // http://behavior3js.guineashots.com/ -> When all children return true, priority will run on that parent\r\n        // Out of range would be better as a decorator.\r\n        // You can load all this from JSON ultimately (see docs above)\r\n        this.tree.root = new b3.Priority({\r\n            children: [\r\n                new b3.Sequence({\r\n                    children: [\r\n                        new OutOfRange(),\r\n                        new Idle()\r\n                    ]\r\n                }),\r\n                new b3.Sequence({\r\n                    children: [\r\n                        new InRange(),\r\n                        new Follow()\r\n                    ]\r\n                })\r\n            ]\r\n        });\r\n\r\n    }\r\n\r\n    update() {\r\n\r\n        this.body.velocity.x = 0;\r\n\r\n        this.tree.tick(this, this.blackboard);\r\n\r\n        if (this.currentTarget) {\r\n            let dist = Helpers.Dist(this, this.currentTarget);\r\n            this.blackboard.set('inRangeOfTarget', dist < this.config.alertRange);\r\n        }\r\n\r\n    }\r\n\r\n    chaseTarget() {\r\n\r\n        let dirToTarget = this.blackboard.get('currentTarget').x > this.x ? 1 : -1;\r\n        this.move(dirToTarget);\r\n\r\n    }\r\n\r\n    move(dir) {\r\n\r\n        if (Helpers.Dist(this, this.currentTarget) < 5)\r\n            return;\r\n\r\n        this.body.velocity.x += dir > 0 ? this.config.movementSpeed : -this.config.movementSpeed;\r\n\r\n    }\r\n\r\n    setTarget(t) {\r\n\r\n        this.currentTarget = t;\r\n        this.blackboard.set('currentTarget', this.currentTarget);\r\n\r\n    }\r\n\r\n    takeDamage(n, origin) {\r\n\r\n        console.log(this.name + \" is taking damage: \" + n);\r\n        console.log(origin, \"was origin of damage.\");\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Enemy;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/Enemy.js","// https://github.com/renatopp/behavior3js/wiki/Core-04-Creating-Custom-Nodes\r\nlet Idle = b3.Class(b3.Action);\r\n\r\nIdle.prototype.name = 'Idle';\r\n\r\nIdle.prototype.open = function (tick) {\r\n\r\n    console.log(\"Idle...\");\r\n    console.log(tick);\r\n\r\n};\r\n\r\nIdle.prototype.tick = function (tick) {\r\n\r\n    return b3.RUNNING;\r\n\r\n};\r\n\r\nexport default Idle;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/nodes/actions/Idle.js","import 'b3';\r\n\r\nlet Follow = b3.Class(b3.Action);\r\n\r\nFollow.prototype.name = 'Follow';\r\n\r\nFollow.prototype.open = function (tick) {\r\n\r\n    console.log(\"Follow...\");\r\n    console.log(tick);\r\n\r\n};\r\n\r\nFollow.prototype.tick = function (tick) {\r\n\r\n    tick.target.chaseTarget();\r\n    return b3.RUNNING;\r\n\r\n};\r\n\r\nexport default Follow;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/nodes/actions/Follow.js","import 'b3';\r\n\r\nlet InRange = b3.Class(b3.Condition);\r\n\r\nInRange.prototype.name = 'InRange';\r\n\r\nInRange.prototype.tick = function (tick) {\r\n\r\n    if (tick.blackboard.get('inRangeOfTarget'))\r\n        return b3.SUCCESS;\r\n\r\n    return b3.FAILURE;\r\n\r\n};\r\n\r\nexport default InRange;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/nodes/conditions/InRange.js","import 'b3';\r\n\r\nlet OutOfRange = b3.Class(b3.Condition);\r\n\r\nOutOfRange.prototype.name = 'OutOfRange';\r\n\r\nOutOfRange.prototype.tick = function (tick) {\r\n\r\n    if (!tick.blackboard.get('inRangeOfTarget'))\r\n        return b3.SUCCESS;\r\n\r\n    return b3.FAILURE;\r\n\r\n};\r\n\r\nexport default OutOfRange;\n\n\n// WEBPACK FOOTER //\n// ./src/ai/nodes/conditions/OutOfRange.js","class Weapon extends Phaser.Sprite {\r\n\r\n    constructor(game, x, y, name) {\r\n\r\n        super(game, x, y, name);\r\n\r\n        game.add.existing(this);\r\n        game.physics.arcade.enable(this);\r\n\r\n        this.id = \"???\";\r\n        this.name = name;\r\n        this.body.allowGravity = false;\r\n        this.body.enable = false;\r\n        this.alpha = 0;\r\n\r\n        // You can override this\r\n        this.stats = {\r\n            damageOutput: 1\r\n        };\r\n\r\n    }\r\n\r\n    damageOutput() {\r\n        return this.stats.damageOutput;\r\n    }\r\n\r\n    use() {\r\n\r\n        // TODO: To clean up properly. :P\r\n        if (this.body.enabled)\r\n            return;\r\n\r\n        this.body.enable = true;\r\n        this.alpha = 1;\r\n\r\n        let self = this;\r\n        setTimeout(function () {\r\n            self.body.enable = false;\r\n            self.alpha = 0;\r\n        }, 100);\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Weapon;\n\n\n// WEBPACK FOOTER //\n// ./src/entities/Weapon.js","class Helpers {\r\n\r\n    static Dist(object, target) {\r\n\r\n        let a = object.x - target.x;\r\n        let b = object.y - target.y;\r\n\r\n        return Math.sqrt(a * a + b * b);\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Helpers;\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/Helpers.js"],"sourceRoot":""}